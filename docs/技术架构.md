# ChatGPT式对话应用技术架构

## 技术选型

### 前端框架
**React + TypeScript**
- 组件化开发效率高
- TypeScript提供类型安全，减少运行时错误
- 丰富的生态系统和社区支持

### 前端存储方案
**IndexedDB + localStorage**
- localStorage：存储API密钥和简单配置
- IndexedDB：存储对话历史记录（支持大量数据）
- 优势：完全客户端存储，无需服务器

### UI组件库
**Chakra UI**
- 轻量级、可定制性高、设计简约
- 响应式设计支持
- 提供丰富的图标支持
- 支持暗黑模式

### AI API集成
**OpenAI API客户端实现**
- 支持传递上下文，维持对话记忆
- 用户可配置API密钥和其他相关参数

### 导出功能实现
- React-Markdown：渲染和处理Markdown
- html2pdf.js：导出PDF功能
- mammoth.js：导出Word文档
- 自定义右键菜单：实现右键复制、粘贴功能

## 项目结构
```
chat-app/
├── public/                # 静态资源
├── src/
│   ├── components/        # UI组件
│   │   ├── Chat/          # 聊天相关组件
│   │   ├── Settings/      # 设置相关组件
│   │   └── Export/        # 导出功能组件
│   ├── hooks/             # 自定义hooks
│   ├── services/          # API服务
│   ├── store/             # 状态管理
│   ├── utils/             # 工具函数
│   └── App.tsx            # 应用入口
└── package.json           # 依赖配置
```

## 核心依赖包

| 依赖包 | 版本 | 用途 |
|-------|------|------|
| react | ^18.2.0 | 前端UI框架 |
| typescript | ^4.9.5 | 类型系统 |
| chakra-ui | ^2.8.0 | UI组件库 |
| idb | ^7.1.1 | IndexedDB封装 |
| axios | ^1.4.0 | API请求 |
| react-markdown | ^8.0.7 | Markdown渲染 |
| html2pdf.js | ^0.10.1 | PDF导出 |
| mammoth | ^1.5.1 | Word导出 |

## 开发环境配置
- Node.js >= 14.0.0
- npm >= 7.0.0
- create-react-app脚手架
- VSCode + ESLint + Prettier

## 部署配置

### 开发环境端口配置
为避免与其他项目端口冲突，应用配置使用25050端口：

**方法一：使用.env文件（推荐）**
```
# 项目根目录创建.env文件
PORT=25050
```

**方法二：修改package.json**
```json
"scripts": {
  "start": "set PORT=25050 && react-scripts start", // Windows
  "start": "PORT=25050 react-scripts start"         // macOS/Linux
}
```

**方法三：命令行指定**
```bash
# Windows
set PORT=25050 && npm start

# macOS/Linux
PORT=25050 npm start
```

### 生产环境部署
1. **构建应用**
   ```bash
   npm run build
   ```

2. **部署选项**
   - 静态文件服务器：`npx serve -s build -l 25050`
   - Nginx配置监听25050端口
   - Docker容器配置映射到25050端口
