# 平行AI分析插件

## 功能概述

平行AI分析插件通过并行调用第二个AI服务来分析用户输入，在特定场景下提供辅助功能推荐。它能够：

1. 分析用户输入的意图，识别特定的使用场景
2. 提供针对性的功能建议和预填充输入
3. 与May主应用完全解耦，可随时启用或禁用

## 主要组件

### 1. 插件演示与配置界面 (PluginDemo)

![PluginDemo示意图](https://placeholder-image.com/plugin-demo)

- **用户输入模拟区**：测试不同用户输入的效果
- **系统提示词编辑器**：配置提交给辅助AI的提示词
- **API配置区**：设置辅助AI服务的API参数
- **结果展示区**：显示分析结果和UI效果预览

### 2. 平行AI分析组件 (ParallelAIPlugin)

此组件用于集成到May的实际聊天界面中，在用户输入消息后分析意图并显示建议。

## 工作原理

1. **输入分析**：用户在May应用输入消息后，系统同时将消息发送给：
   - 主AI服务（正常流程）
   - 辅助AI服务（意图分析）

2. **意图识别**：辅助AI根据系统提示词分析用户意图，返回JSON格式的结果：
   ```json
   {
     "type": "a" | "b" | "none",
     "suggestion": {
       "text": "提示文本",
       "input": {
         // 对于type="a"(销售话术)场景：
         "product": "提取的产品名称",
         "position": "提取的目标客户职位"
         // 对于type="b"(市场分析)场景：
         "product": "提取的产品名称"
       }
     }
   }
   ```

3. **建议展示**：如果识别出特定意图（type=a或b），系统将在界面上显示相应建议，用户可以：
   - 点击"忽略"按钮关闭建议
   - 点击"执行"按钮使用对应功能

## 支持的场景

目前支持两种特定场景的识别：

1. **销售话术生成** (type="a")
   - 触发条件：用户需要推销特定产品给特定职位的客户
   - 提取信息：产品名称 + 目标客户职位

2. **市场分析报告** (type="b")
   - 触发条件：用户需要生成某产品的市场分析报告
   - 提取信息：产品名称

## 如何使用

### 1. 访问配置界面

您可以通过以下两种方式访问插件配置界面：

- URL参数：在应用URL后添加 `?demo=plugin`
- 键盘快捷键：同时按住 `fn+A+P+I`

### 2. 配置插件

在配置界面上：

1. 设置系统提示词（用于指导辅助AI如何分析用户意图）
2. 配置响应映射（定义不同类型建议的文本和按钮）
3. 设置辅助AI服务的API参数
4. 启用平行AI分析功能

### 3. 测试分析效果

使用界面上的测试案例或输入自定义文本，点击"测试分析"按钮查看效果。

## 集成说明

此插件已被设计为与May主应用完全解耦，只需以下几个步骤即可集成：

1. 在ChatInterface.tsx中导入ParallelAIPlugin组件
2. 在InputArea组件附近添加此组件，传入用户输入
3. 配置键盘快捷键监听，支持Ctrl+A+P+I打开配置页面

## 安全与隐私

- API密钥经过加密后存储在localStorage中
- 所有分析都在客户端完成，不依赖外部服务器
- 插件可随时禁用，不影响主应用功能

## 扩展性

此插件设计具有高度扩展性：

1. **添加新的意图类型**：只需在系统提示词中定义新场景，并在响应映射中添加相应配置
2. **支持更多AI服务**：可扩展ApiConfig组件支持其他API提供商
3. **自定义UI效果**：通过修改CSS变量适应不同主题

## 技术实现

- React + TypeScript
- OpenAI API客户端（支持自定义API端点）
- localStorage持久化存储配置
- 使用May应用已有的CSS变量体系

此插件完全符合May的设计风格和开发最佳实践，可无缝集成到现有应用中。
